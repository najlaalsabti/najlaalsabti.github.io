<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Massively by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
		<script src="https://unpkg.com/ml5@latest/dist/ml5.min.js" type="text/javascript"></script>
		 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
 <script type="text/javascript" src="https://code.jquery.com/jquery-1.9.0.min.js"></script>
 <link
		href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
		rel="stylesheet"
		integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
		crossorigin="anonymous"
	/>
	<script src="https://code.responsivevoice.org/responsivevoice.js?key=w5ddl1wX"></script> <!-- replace with KEY-->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
		 <style>
		 .icon>ul>li>a{
		 	color: white;
		 }
		 </style>
	</head>
	<body class="is-preload">
		<!-- <script src="sketch_image.js" ></script>

		<!-- Wrapper -->
			<div id="wrapper" class="fade-in">

				<!-- Intro -->
					<div class="intr" style="position:fixed; left:27%; top:8%;" >
						<center>
						<h2 class="mt-4 " style="color:white; font-style: italic;">Now please Say:</h2>
				    <h3 style="color:white; font-style: italic;">I am fine and I can pronounce correctly</h3>
					</center>
					</div>
						<div class="intr" style="position:fixed; left:31%; top:25%;" >
				    <div class="p-3" style="border: 1px solid gray; width:520px; height: 400px; border-radius: 8px;">
				      <span id="final" ></span>
				      <span id="interim" class="text-secondary"></span>
				    </div>
				    <div class="mt-4">
				      <button class="btn" id="repeat">Repeat</button>
				      <p id="status" class="lead mt-3 " style=" display: none; color:white;">Listenting ...</p>
				    </div>
				    <h1 id="pronounciationResult"></h1>
					</div>
				</div>

					<div class="intr" style="position:fixed; left:47.5%; top:80%;" >
						  <ul class="actions">
								<li><a href="eye.html" class="button icon solid solo fa-arrow-down scrolly icon" style="color:white;">Continue</a></li>
							</ul>
					</div>

     <!-- <div id="intro">
			 Hello
			 <img src="overlay.png">
		 </div> -->



		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
			console.log(localStorage.getItem("x"));
			if ("webkitSpeechRecognition" in window) {
    // Initialize webkitSpeechRecognition
    let speechRecognition = new webkitSpeechRecognition();

    // String for the Final Transcript
    let final_transcript = "";

    // Set the properties for the Speech Recognition object
    speechRecognition.continuous = true;
    speechRecognition.interimResults = true;


    // Callback Function for the onStart Event
    speechRecognition.onstart = () => {
      // Show the Status Element
      document.querySelector("#status").style.display = "block";
    };



    speechRecognition.onerror = () => {
      // Hide the Status Element
      document.querySelector("#status").style.display = "none";
    };



    speechRecognition.onend = () => {
      // Hide the Status Element
      document.querySelector("#status").style.display = "none";
    };




    speechRecognition.onresult = (event) => {
      // Create the interim transcript string locally because we don't want it to persist like final transcript
      let interim_transcript = "";

      // Loop through the results from the speech recognition object.
      for (let i = event.resultIndex; i < event.results.length; ++i) {
        // If the result item is Final, add it to Final Transcript, Else add it to Interim transcript
        if (event.results[i].isFinal) {
          final_transcript += event.results[i][0].transcript;
        } else {
          interim_transcript += event.results[i][0].transcript;
        }
      }

      // Set the Final transcript and Interim transcript.
      document.querySelector("#final").innerHTML = final_transcript;
      document.querySelector("#interim").innerHTML = interim_transcript;
    };


    // Set the onClick property of the repeat button
    document.querySelector("#repeat").onclick = () => {
      // Repeat the Speech Recognition
      document.querySelector("#final").innerHTML = ""
      document.querySelector("#pronounciationResult").innerHTML = ""
      final_transcript = ""
      tenSecRecognition();
      // speechRecognition.start();

    };



    window.onload = async () => {
      // Start the Speech Recognition
			// setInterval(responsiveVoice.speak("Please Say, I am fine and I can pronounce correctly"));
			// setTimeout(responsiveVoice.speak("Please Say, I am fine and I can pronounce correctly"), 10000);
			responsiveVoice.speak("Now, please Say, I am fine and I can pronounce correctly");
			 // clearInterval();
			 setTimeout(tenSecRecognition, 5000);

    };


    tenSecRecognition = async () =>{
      speechRecognition.start();
      await new Promise(resolve => setTimeout(resolve, 10000));
      speechRecognition.stop();
      result();
    };

    result = () =>{
      if(final_transcript == "I am fine and I can pronounce correctly"){

					localStorage.setItem("y", "false");
					console.log(localStorage.getItem("y"));

        // document.querySelector("#pronounciationResult").innerHTML = "you are fine :)";
      }
      else{
				localStorage.setItem("y", "true");
				console.log(localStorage.getItem("y"));

        // document.querySelector("#pronounciationResult").innerHTML = "Please check again or call Emergency!";
        // if(final_transcript != "I am fine and I can pronounce correctly"){
        //   document.querySelector("#pronounciationResult").innerHTML = "Emergency Case!";
        // }
        // else {
        //   document.querySelector("#pronounciationResult").innerHTML = "you are fine2 :)";
        // }
      }
      // document.querySelector("#pronounciationResult").innerHTML = final_transcript;
    }


  } else {
    console.log("Speech Recognition Not Available");

  }

			</script>

	</body>
</html>
